Introduction:
This program is designed for generating a robust script for on-the-fly data processing. It combines user input and relion commands to generate a bash script for automatic pre-processing, including Import, Motion Correction, Ctf estimation, particle picking, particle extraction, and optionally 2d classification. Basically, it works pretty much like the cryosparc live.

Notice:
The program is designed for on-the-fly data processing, it is meaningless to use this program if you start data processing after the data collection finishes.

For sake of ease of use, the program is designed in sacrifise of fexibility. For instance, user can only use motioncorr2 to do motion corrections, gctf  to do ctf estimation, relion picking(with or without template) for particle picking. Also, some parameters are not adjustable.

Some settings is not applicable to other institution, as many of the setting is designed on the setting of Purdue cryo-EM facility.
A major difference among different institutions is how you import the  movies or motion corrected images to you relion folder.
For instance, The data generated by Titan Krios in Purdue is stored in local file system (/net/em) that the user can access it like local files. While other places may need  "rsync" or other syncing tools to import the real-time data.

2D classiification job is submited to job queue via squeue jobs scheduling system. It needs local modidification to your job scheduling system.


Usage:
The program is designed in the two different modes, auto and collect mode.

In auto mode, the program will initiate a relion project and create a series of jobs for you to visualize, and generate a bash script for you to run in the terminal. The auto mode works in the following scenarios:
python 12345.py auto
    If you had a template for particle picking, and want to leave the motion correction to Appion
    The program will eventually genreate a bash script called 1345.sh for you.
python 12345.py auto --new_sample
    If you collect on a brand new sample(therefore you don't have a template for particle picking), and want to leave the motion correction to Appion.
    The program will eventually genreate a bash script called 1345.sh for you.
python 12345.py auto --do_motioncorrection
    If have a template for particle picking, and wanna do motion correction for the possible particle polishing.
    The program will eventually genreate a bash script called 12345.sh for you.
python 12345.py auto --new_sample --do_motioncorrection
    If you collect on a brand new sample, and want to leave the motion correction to Appion.
    The program will eventually genreate a bash script called 12345.sh for you.
python 12345.py auto --new_sample --do_motioncorrection --run2d
    Optionally, you can ask the program to run 2d classification for you.
    The program will eventually genreate a bash script called 12345.sh for you.

If you had setup a relion project, fine tuned some parameters with a small dataset, and wanna continue processing the upcoming data, you need the "collect" mode. To use the collect mode, you need to tell the program the extraction job number with  correct settings, and the program will collect all the commands of its parents and assemble them into a ready-to-go bash script.
In this mode, the --new_sample --do_motioncorrection parameters won't work at all.

python 12345.py collect 
python 12345.py collect --run2d